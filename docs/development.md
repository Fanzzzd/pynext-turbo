# Development Guide

This guide covers the development workflow, project structure, and key scripts for Pynext-Turbo.

## ‚ö° Quick Start

For a fresh start, the `init_dev.sh` script automates the entire setup process.

1.  **Prerequisites**: [Docker](https://www.docker.com/), [pnpm](https://pnpm.io/installation), and [uv](https://github.com/astral-sh/uv).
2.  **Run the script** from the project root:

    ```bash
    ./init_dev.sh
    ```

    This script will:
    - Check for required tools.
    - Copy `.env.example` files to `.env` if they don't exist.
    - Start a PostgreSQL database in a Docker container.
    - Wait for the database to be ready.
    - Install all Node.js and Python dependencies.
    - Generate and run the initial database migration.
    - Generate the type-safe API client.

3.  **Start the development servers**:
    ```bash
    pnpm dev
    ```
    This launches:
    - Next.js frontend on `http://localhost:3000`
    - FastAPI backend on `http://localhost:8000` (Docs at `http://localhost:8000/docs`)
    - A file watcher that automatically regenerates the API client on backend changes.

---

## üë©‚Äçüíª Development Workflow

### Database Migrations with Alembic

This template uses [Alembic](https://alembic.sqlalchemy.org/) for database migrations, powered by your [SQLModel](https://sqlmodel.tiangolo.com/) definitions.

1.  **Change your models**: Modify your SQLModel classes in `apps/api/src/models.py`. For example, add a new field to the `Hero` model.

2.  **Generate a migration script**: Run the `db:generate` script with a descriptive message.

    ```bash
    pnpm db:generate "add new_field to hero model"
    ```

    This command uses Alembic to compare your models against the database schema and creates a new migration file in `apps/api/alembic/versions/`.

3.  **Apply the migration**:
    ```bash
    pnpm db:migrate
    ```
    This applies any pending migrations to your database. The local development database will be updated.

### API Client Generation

One of the core features of Pynext-Turbo is the automatically generated, type-safe API client.

- **How it works**: When you run `pnpm dev`, a `nodemon` process watches for changes in the `apps/api/src/` directory.
- **On change**:
  1.  Your FastAPI application's OpenAPI schema (`openapi.json`) is regenerated.
  2.  The `openapi-ts` tool reads this schema and generates a new TypeScript client in `packages/api-client/`.
- **Result**: Any changes you make to your API's routes or data models are immediately available with full type safety in your frontend code, usually without even needing to restart your IDE's TypeScript server.

### ‚ö†Ô∏è Auto-generated Files: Do Not Edit Manually

The following files and directories are generated automatically. **Any manual changes will be overwritten.**

- **`apps/api/openapi.json`**: Generated from the live FastAPI app.
- **`packages/api-client/src/requests/`**: The entire contents of this directory are generated by `openapi-ts`.
